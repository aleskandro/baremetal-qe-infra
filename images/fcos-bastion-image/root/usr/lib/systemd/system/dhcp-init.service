[Unit]
Description=Init configuration for dhcp and tftpboot with dnsmasq
Wants=network-online.target
After=network-online.target
RequiresMountsFor=%t/containers
ConditionPathExists=!/var/.dhcp-configured

[Service]
Environment=PODMAN_SYSTEMD_UNIT=%n
EnvironmentFile=/usr/share/bastion_services/dhcp/dhcp_systemd.conf
Restart=on-failure
TimeoutStartSec=300
ExecStartPre=/bin/rm -f %t/%n.ctr-id
ExecStartPre=/bin/bash -c '/usr/bin/dhcp-init.sh | tee /var/log/dhcp-init.log 2>&1'
ExecStart=/bin/touch /var/.dhcp-configured
Type=oneshot
RemainAfterExit=no

[Install]
WantedBy=default.target
